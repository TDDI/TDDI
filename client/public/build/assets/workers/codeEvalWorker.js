onmessage=function(e){var code=e.data[0],preOp=e.data[1],options=e.data[2],scripts=options.scripts,result=void 0,error=!1;for(var i in scripts)importScripts(scripts[i]);var expect=chai.expect;eval(preOp),failureCases=failureCases||[],successCases=successCases||[];var test=function(scope){for(var key in scope)eval(key+"=scope[key];");return function(){var failureCases=void 0,successCases=void 0,error=void 0,result=void 0,scope=void 0,key=void 0;try{eval(code)}catch(e){return e.toString()}}()};for(var i in successCases){var successCase=successCases[i],response=test(successCase.scope);if(response){error=response+"\n"+successCase.failMessage;for(var key in successCase.scope)error+="\n  '"+key+"':"+successCase.scope[key].toString();break}}if(!error)for(var i in failureCases){var failureCase=failureCases[i],response=test(failureCase.scope);if(!response){error=failureCase.failMessage;for(var key in failureCase.scope)error+="\n  '"+key+"':"+failureCase.scope[key];break}}postMessage({result:result,error:error})};